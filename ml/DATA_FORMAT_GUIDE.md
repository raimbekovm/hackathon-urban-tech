# üì¶ –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è YOLO (RDD2022 —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π)

## üéØ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫

–í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```
bishkek_annotated/
‚îú‚îÄ‚îÄ train/
‚îÇ   ‚îú‚îÄ‚îÄ images/          # –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ img_001.jpg
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ img_002.jpg
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ labels/          # –ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ YOLO
‚îÇ       ‚îú‚îÄ‚îÄ img_001.txt
‚îÇ       ‚îú‚îÄ‚îÄ img_002.txt
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ val/                 # –í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä (10-20% –¥–∞–Ω–Ω—ã—Ö)
‚îÇ   ‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îî‚îÄ‚îÄ labels/
‚îî‚îÄ‚îÄ test/                # –¢–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä (10-20% –¥–∞–Ω–Ω—ã—Ö, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    ‚îú‚îÄ‚îÄ images/
    ‚îî‚îÄ‚îÄ labels/
```

## üìù –§–æ—Ä–º–∞—Ç –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π YOLO

–ö–∞–∂–¥–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –∏–º–µ—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π `.txt` —Ñ–∞–π–ª —Å –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏.

### –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏:
```
class_id x_center y_center width height
class_id x_center y_center width height
...
```

**–í–∞–∂–Ω–æ:** –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã –æ—Ç 0 –¥–æ 1 (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–∑–º–µ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)

### –ü—Ä–∏–º–µ—Ä:
–ï—Å–ª–∏ —É –≤–∞—Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 1920x1080, –∏ —è–º–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è:
- –í —Ü–µ–Ω—Ç—Ä–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –†–∞–∑–º–µ—Ä–æ–º 200x150 –ø–∏–∫—Å–µ–ª–µ–π
- –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (860, 465)

–¢–æ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è –±—É–¥–µ—Ç:
```
3 0.5 0.5 0.104 0.139
```

–ì–¥–µ:
- `3` = –∫–ª–∞—Å—Å pothole (—è–º–∞)
- `0.5` = x_center = 960/1920 = 0.5
- `0.5` = y_center = 540/1080 = 0.5
- `0.104` = width = 200/1920 = 0.104
- `0.139` = height = 150/1080 = 0.139

## üè∑Ô∏è –ö–ª–∞—Å—Å—ã RDD2022

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ ID –∫–ª–∞—Å—Å–æ–≤ (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç RDD2022):

```
0 = longitudinal_crack    (–ø—Ä–æ–¥–æ–ª—å–Ω–∞—è —Ç—Ä–µ—â–∏–Ω–∞)
1 = transverse_crack      (–ø–æ–ø–µ—Ä–µ—á–Ω–∞—è —Ç—Ä–µ—â–∏–Ω–∞)
2 = alligator_crack       (—Å–µ—Ç–∫–∞ —Ç—Ä–µ—â–∏–Ω)
3 = pothole               (—è–º–∞/–∫–æ—á–∫–∞)
4 = other_damage          (–¥—Ä—É–≥–∏–µ –¥–µ—Ñ–µ–∫—Ç—ã)
```

## üì• –ö–∞–∫ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Ä–∞–∑–º–µ—Ç–∫–∏

### –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ LabelImg:
1. –û—Ç–∫—Ä–æ–π—Ç–µ LabelImg
2. **View ‚Üí Auto Save mode** (–≤–∫–ª—é—á–∏—Ç–µ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ)
3. **Format ‚Üí YOLO** (–≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç YOLO)
4. –†–∞–∑–º–µ—Ç—å—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫ –≤—ã—à–µ

### –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Roboflow:
1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞—Ç–∞—Å–µ—Ç
2. –ü—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ –≤—ã–±–µ—Ä–∏—Ç–µ: **YOLOv8** —Ñ–æ—Ä–º–∞—Ç
3. –°–∫–∞—á–∞–π—Ç–µ –∞—Ä—Ö–∏–≤
4. –†–∞—Å–ø–∞–∫—É–π—Ç–µ - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —É–∂–µ –±—É–¥–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π

### –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ CVAT (Computer Vision Annotation Tool):
1. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç
2. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç: **YOLO 1.1**
3. –°–∫–∞—á–∞–π—Ç–µ –∞—Ä—Ö–∏–≤
4. –†–∞—Å–ø–∞–∫—É–π—Ç–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É

### –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –¥—Ä—É–≥–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —ç–∫—Å–ø–æ—Ä—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ **YOLO** (–Ω–µ COCO, –Ω–µ Pascal VOC)
- –§–æ—Ä–º–∞—Ç –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π: `class_id x_center y_center width height` (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ 0-1)

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–ü–æ—Å–ª–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

```python
from pathlib import Path

data_path = Path('bishkek_annotated')

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
assert (data_path / 'train' / 'images').exists()
assert (data_path / 'train' / 'labels').exists()
assert (data_path / 'val' / 'images').exists()
assert (data_path / 'val' / 'labels').exists()

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ñ–∞–π–ª–æ–≤
train_images = set(f.stem for f in (data_path / 'train' / 'images').glob('*'))
train_labels = set(f.stem for f in (data_path / 'train' / 'labels').glob('*.txt'))

print(f"Train images: {len(train_images)}")
print(f"Train labels: {len(train_labels)}")
print(f"Match: {train_images == train_labels}")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π
sample_label = (data_path / 'train' / 'labels').glob('*.txt').__next__()
with open(sample_label) as f:
    lines = f.readlines()
    print(f"\nSample annotation ({sample_label.name}):")
    for line in lines:
        parts = line.strip().split()
        if len(parts) == 5:
            class_id, x, y, w, h = map(float, parts)
            print(f"  Class {int(class_id)}: center=({x:.3f}, {y:.3f}), size=({w:.3f}, {h:.3f})")
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å –ø—Ä–æ–µ–∫—Ç–æ–º

–ü–æ—Å–ª–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö:

1. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ –ø—Ä–æ–µ–∫—Ç:**
```bash
cp -r bishkek_annotated ml/data/
```

2. **–°–æ–∑–¥–∞–π—Ç–µ YAML –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:**
```yaml
# ml/data/bishkek.yaml
path: data/bishkek_annotated
train: train/images
val: val/images
test: test/images  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ

nc: 5  # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Å–æ–≤
names:
  0: longitudinal_crack
  1: transverse_crack
  2: alligator_crack
  3: pothole
  4: other_damage
```

3. **–û–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª—å:**
```python
from ultralytics import YOLO

model = YOLO('yolov8n.pt')  # –∏–ª–∏ yolov8s.pt, yolov8m.pt
model.train(
    data='data/bishkek.yaml',
    epochs=50,
    imgsz=640,
    batch=16
)
```

4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å:**
```python
model = YOLO('runs/train/weights/best.pt')
results = model('path/to/image.jpg')
```

## üìä –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞–∑–º–µ—Ç–∫–µ

- **–ú–∏–Ω–∏–º—É–º 100 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ –∫–ª–∞—Å—Å** –¥–ª—è —Ö–æ—Ä–æ—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞
- **–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ —É—Å–ª–æ–≤–∏–π:** –¥–µ–Ω—å/–Ω–æ—á—å, —Ä–∞–∑–Ω—ã–µ –ø–æ–≥–æ–¥—ã, —Ä–∞–∑–Ω—ã–µ —É–≥–ª—ã —Å—ä–µ–º–∫–∏
- **–ë–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤:** —Å—Ç–∞—Ä–∞–π—Ç–µ—Å—å, —á—Ç–æ–±—ã –∫–ª–∞—Å—Å—ã –±—ã–ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –ø—Ä–∏–º–µ—Ä–Ω–æ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ
- **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
  - Train: 70-80%
  - Val: 10-15%
  - Test: 10-15%

## üîß –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑ –¥—Ä—É–≥–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤

–ï—Å–ª–∏ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –≤ –¥—Ä—É–≥–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (COCO, Pascal VOC, etc.), –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```python
# –ü—Ä–∏–º–µ—Ä –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ (–Ω—É–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –≤–∞—à —Ñ–æ—Ä–º–∞—Ç)
from pathlib import Path
import json

def convert_coco_to_yolo(coco_json, output_dir):
    """–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç COCO JSON –≤ YOLO —Ñ–æ—Ä–º–∞—Ç"""
    with open(coco_json) as f:
        coco_data = json.load(f)
    
    # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏...
    # (—Å–º. —É—Ç–∏–ª–∏—Ç—ã —Ç–∏–ø–∞ pycocotools –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ—é)
```

## ‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ train/ –±–µ–∑ val –∏ test?**
A: –î–∞, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏–º–µ—Ç—å val –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è.

**Q: –ù—É–∂–Ω–æ –ª–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤—Ä—É—á–Ω—É—é?**
A: –ù–µ—Ç, –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Ä–∞–∑–º–µ—Ç–∫–∏ –¥–µ–ª–∞—é—Ç —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ –≤ YOLO —Ñ–æ—Ä–º–∞—Ç.

**Q: –ö–∞–∫–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?**
A: YOLOv8 —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 640x640 –∏–ª–∏ –∫—Ä–∞—Ç–Ω–æ —ç—Ç–æ–º—É (1280x1280). –ú–æ–¥–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ—Å–∞–π–∑–∏—Ç.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤–º–µ—Å—Ç–µ —Å RDD2022?**
A: –î–∞! –ü—Ä–æ—Å—Ç–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç–µ –ø–∞–ø–∫–∏ train/images –∏ train/labels –∏–∑ –æ–±–æ–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤.

